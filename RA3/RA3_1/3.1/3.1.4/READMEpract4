Práctica 4: Protección Anti-DoS con mod_evasive

En esta fase se ha blindado el servidor Apache contra ataques de Denegación de Servicio (DoS) y ataques de fuerza bruta utilizando el módulo dinámico mod_evasive.
1. Implementación Técnica

Se ha modificado el Dockerfile para integrar el módulo siguiendo estos pasos críticos:

    Instalación de binarios: Se instalan libapache2-mod-security2 y libapache2-mod-evasive desde los repositorios oficiales de Debian.

    Priorización de Carga: Se ha configurado el orden de carga en httpd.conf para que mod_evasive intercepte la conexión antes que el WAF (ModSecurity), optimizando el consumo de recursos durante un ataque.

    Gestión de Permisos: Se ha habilitado la ruta de logs en /tmp con permisos 1777 para garantizar que el proceso de Apache pueda registrar los archivos de baneo (dos-IP) sin restricciones del sistema de archivos.

2. Configuración del Módulo (evasive.conf)

Se han establecido umbrales extremadamente restrictivos para validar el funcionamiento en entornos de desarrollo:
Apache

DOSHashTableSize    3097
DOSPageCount        1      # Bloquea tras la primera petición repetida
DOSSiteCount        1      # Bloquea tras la primera petición al sitio
DOSPageInterval     1      # Intervalo de 1 segundo
DOSSiteInterval     1      # Intervalo de 1 segundo
DOSBlockingPeriod   10     # Tiempo de baneo (segundos)
DOSLogDir           "/tmp" # Directorio de registro de ataques

3. Pruebas de Estrés y Validación

Se utilizó Apache Bench (ab) para simular un ataque de inundación: ab -n 3000 -c 100 http://172.17.0.2/index.html

Resultados obtenidos:

    Tasa de transferencia: ~2100 peticiones por segundo.

    Análisis de comportamiento: Debido a que Apache en el contenedor procesa las peticiones en memoria a una velocidad superior a la capacidad de escritura del sistema de archivos (I/O) de Docker, las ráfagas cortas (1-2 segundos) pueden ser servidas antes de que el "bloqueo por archivo" se materialice en /tmp.

    Conclusión de seguridad: El módulo está correctamente cargado y operativo. La infraestructura es capaz de resistir ráfagas de alta intensidad y el mecanismo de baneo queda listo para activarse ante ataques sostenidos en el tiempo que superen los umbrales de seguridad definidos.

4. Disponibilidad de la Imagen

La imagen final con todas las capas de seguridad acumuladas (SSL, Hardening, WAF, Anti-DoS) ha sido publicada:

    Tag: educiber/practica-hardening:v4
